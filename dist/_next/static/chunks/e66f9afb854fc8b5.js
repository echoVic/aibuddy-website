(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,58887,e=>{"use strict";var r=e.i(47167),a=e.i(43476),t=e.i(71645),o=e.i(67881);let l=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function n({product:e}){let[n,c]=(0,t.useState)(!0),[i,s]=(0,t.useState)(""),d=(0,t.useRef)(null);(0,t.useEffect)(()=>{if(document.getElementById("paypal-script")){window.paypal&&d.current&&y();return}let e=document.createElement("script");return e.id="paypal-script",e.src=`https://www.paypal.com/sdk/js?client-id=${r.default.env.NEXT_PUBLIC_PAYPAL_CLIENT_ID}&currency=USD&intent=capture&commit=true`,e.async=!0,e.onload=()=>{console.log("PayPal SDK loaded"),d.current&&y()},e.onerror=e=>{console.error("PayPal SDK failed to load:",e),s("Failed to load PayPal. Please check your internet connection and try again."),c(!1)},document.body.appendChild(e),()=>{}},[]);let y=()=>{if(!window.paypal||!d.current){s("PayPal is not available"),c(!1);return}try{let r=window.paypal.Buttons({style:{layout:"vertical",color:"gold",shape:"rect",label:"pay"},createOrder:async()=>{try{let r=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productId:e.id,price:e.price,name:e.name})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.error||"Failed to create order")}return(await r.json()).orderId}catch(e){throw console.error("Create order error:",e),e}},onApprove:async e=>{try{if(!(await fetch("/api/capture",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:e.orderID})})).ok)throw Error("Payment capture failed");window.location.href="/dashboard?success=true"}catch(e){console.error("Capture error:",e),s("Payment failed. Please try again.")}},onError:e=>{console.error("PayPal error:",e),s("An error occurred with PayPal. Please try again.")},onCancel:()=>{console.log("Payment cancelled")}});if(!r.isEligible()){s("PayPal is not available for this browser. Please try a different payment method."),c(!1);return}r.render(d.current).then(()=>{console.log("PayPal buttons rendered successfully"),c(!1)}).catch(e=>{console.error("Render error:",e),s("Failed to display PayPal buttons. Please refresh the page."),c(!1)})}catch(e){console.error("Error creating buttons:",e),s("Failed to initialize PayPal. Please try again later."),c(!1)}};return i?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-red-500 text-sm text-center",children:i}),(0,a.jsx)(o.Button,{onClick:()=>window.location.reload(),variant:"outline",className:"w-full",children:"Retry"})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[n&&(0,a.jsxs)(o.Button,{disabled:!0,className:"w-full",children:[(0,a.jsx)(l,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading PayPal..."]}),(0,a.jsx)("div",{ref:d,className:`min-h-[45px] ${n?"hidden":""}`}),!n&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Secure payment powered by PayPal"})]})}e.s(["default",()=>n],58887)}]);